<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. web 缓存 | 震雨 luckrain7&#39;s 博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="震雨LuckRain7的博客,Webgis,arcgis,openlayer,css,javascript">
    
    <link rel="preload" href="/assets/css/0.styles.44f275cc.css" as="style"><link rel="preload" href="/assets/js/app.935d9423.js" as="script"><link rel="preload" href="/assets/js/2.937ff587.js" as="script"><link rel="preload" href="/assets/js/37.3be73234.js" as="script"><link rel="prefetch" href="/assets/js/10.9a577aa1.js"><link rel="prefetch" href="/assets/js/11.c3b673ad.js"><link rel="prefetch" href="/assets/js/12.c29e86c7.js"><link rel="prefetch" href="/assets/js/13.eb86436a.js"><link rel="prefetch" href="/assets/js/14.4170538a.js"><link rel="prefetch" href="/assets/js/15.f42a0ed2.js"><link rel="prefetch" href="/assets/js/16.d9167ef9.js"><link rel="prefetch" href="/assets/js/17.502315c5.js"><link rel="prefetch" href="/assets/js/18.8c353890.js"><link rel="prefetch" href="/assets/js/19.f33f0996.js"><link rel="prefetch" href="/assets/js/20.a6143f56.js"><link rel="prefetch" href="/assets/js/21.d5d40115.js"><link rel="prefetch" href="/assets/js/22.24f57cb8.js"><link rel="prefetch" href="/assets/js/23.1107f01c.js"><link rel="prefetch" href="/assets/js/24.c7e7037f.js"><link rel="prefetch" href="/assets/js/25.081de34c.js"><link rel="prefetch" href="/assets/js/26.97575d4f.js"><link rel="prefetch" href="/assets/js/27.7c51f45a.js"><link rel="prefetch" href="/assets/js/28.935def2d.js"><link rel="prefetch" href="/assets/js/29.f5ad8c3a.js"><link rel="prefetch" href="/assets/js/3.f756556b.js"><link rel="prefetch" href="/assets/js/30.70764e95.js"><link rel="prefetch" href="/assets/js/31.27c32a8e.js"><link rel="prefetch" href="/assets/js/32.ded06f1c.js"><link rel="prefetch" href="/assets/js/33.0e50d83e.js"><link rel="prefetch" href="/assets/js/34.011e9526.js"><link rel="prefetch" href="/assets/js/35.09cd062c.js"><link rel="prefetch" href="/assets/js/36.4a0d4cea.js"><link rel="prefetch" href="/assets/js/38.efd6b81a.js"><link rel="prefetch" href="/assets/js/39.81019fa0.js"><link rel="prefetch" href="/assets/js/4.3c8fca19.js"><link rel="prefetch" href="/assets/js/40.fbf3ea7c.js"><link rel="prefetch" href="/assets/js/41.6c8c9043.js"><link rel="prefetch" href="/assets/js/42.e7e800a5.js"><link rel="prefetch" href="/assets/js/43.4e4907ad.js"><link rel="prefetch" href="/assets/js/44.5f4890ba.js"><link rel="prefetch" href="/assets/js/45.51f35c80.js"><link rel="prefetch" href="/assets/js/46.a0785457.js"><link rel="prefetch" href="/assets/js/47.c31bbd22.js"><link rel="prefetch" href="/assets/js/48.e8f0a5a8.js"><link rel="prefetch" href="/assets/js/49.9c3c33d6.js"><link rel="prefetch" href="/assets/js/5.312e4ba4.js"><link rel="prefetch" href="/assets/js/50.3cbdd383.js"><link rel="prefetch" href="/assets/js/51.ed507d4e.js"><link rel="prefetch" href="/assets/js/52.fb3918dc.js"><link rel="prefetch" href="/assets/js/53.042d4033.js"><link rel="prefetch" href="/assets/js/54.cbc88fe9.js"><link rel="prefetch" href="/assets/js/55.c463e504.js"><link rel="prefetch" href="/assets/js/56.8c2c89bc.js"><link rel="prefetch" href="/assets/js/57.adc6a5f7.js"><link rel="prefetch" href="/assets/js/58.7661d6bd.js"><link rel="prefetch" href="/assets/js/59.0a4954d6.js"><link rel="prefetch" href="/assets/js/6.d7736eb9.js"><link rel="prefetch" href="/assets/js/60.83e3be2b.js"><link rel="prefetch" href="/assets/js/61.fe2c8482.js"><link rel="prefetch" href="/assets/js/62.c1e959aa.js"><link rel="prefetch" href="/assets/js/63.f2a4b0fb.js"><link rel="prefetch" href="/assets/js/64.3fca7f5f.js"><link rel="prefetch" href="/assets/js/65.b2ac6aee.js"><link rel="prefetch" href="/assets/js/66.d090de89.js"><link rel="prefetch" href="/assets/js/67.40bcaf05.js"><link rel="prefetch" href="/assets/js/68.881fd0d3.js"><link rel="prefetch" href="/assets/js/69.bbda20f9.js"><link rel="prefetch" href="/assets/js/7.66487b7b.js"><link rel="prefetch" href="/assets/js/70.ac3d046d.js"><link rel="prefetch" href="/assets/js/71.da681440.js"><link rel="prefetch" href="/assets/js/72.ae29fd88.js"><link rel="prefetch" href="/assets/js/73.97cdabee.js"><link rel="prefetch" href="/assets/js/74.4b0c79d4.js"><link rel="prefetch" href="/assets/js/75.484566e6.js"><link rel="prefetch" href="/assets/js/76.cc2405d9.js"><link rel="prefetch" href="/assets/js/77.63078b63.js"><link rel="prefetch" href="/assets/js/78.c489f01f.js"><link rel="prefetch" href="/assets/js/79.955430f2.js"><link rel="prefetch" href="/assets/js/8.c5c00427.js"><link rel="prefetch" href="/assets/js/80.76288a26.js"><link rel="prefetch" href="/assets/js/81.01c77473.js"><link rel="prefetch" href="/assets/js/82.305d1fe3.js"><link rel="prefetch" href="/assets/js/83.f1999d56.js"><link rel="prefetch" href="/assets/js/84.827e5a44.js"><link rel="prefetch" href="/assets/js/9.51c4686b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.44f275cc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">震雨 luckrain7's 博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home/" class="nav-link">
  个人介绍
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/HTML.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/frontend/CSS.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/JavaScript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/TypeScript.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/Vue/Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/React/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/frontend/Webpack/" class="nav-link">
  Webpack
</a></li></ul></div></div><div class="nav-item"><a href="/engineering/engineering/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><span class="title">面试</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试" class="mobile-dropdown-title"><span class="title">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ms/DesignMode.html" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/ms/Algorithm.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/ms/JavaScript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/ms/CSS.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/ms/safe.html" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/ms/Vue.html" class="nav-link">
  Vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端" class="dropdown-title"><span class="title">服务端</span> <span class="arrow down"></span></button> <button type="button" aria-label="服务端" class="mobile-dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/server/Node/" class="nav-link">
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/server/Golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/server/Python/" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="WebGIS" class="dropdown-title"><span class="title">WebGIS</span> <span class="arrow down"></span></button> <button type="button" aria-label="WebGIS" class="mobile-dropdown-title"><span class="title">WebGIS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/WebGIS/index.html" class="nav-link">
  README
</a></li><li class="dropdown-item"><!----> <a href="/WebGIS/Cesium/" class="nav-link">
  Cesium
</a></li><li class="dropdown-item"><!----> <a href="/WebGIS/ArcGIS/" class="nav-link">
  ArcGIS
</a></li><li class="dropdown-item"><!----> <a href="/WebGIS/OpenLayer/" class="nav-link">
  OpenLayer
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="必备工具" class="dropdown-title"><span class="title">必备工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="必备工具" class="mobile-dropdown-title"><span class="title">必备工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/package/" class="nav-link">
  包管理器
</a></li><li class="dropdown-item"><!----> <a href="/tools/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/GitHub/" class="nav-link">
  GitHub
</a></li><li class="dropdown-item"><!----> <a href="/tools/Mac/" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/tools/vscode/" class="nav-link">
  VS Code
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人分享" class="dropdown-title"><span class="title">个人分享</span> <span class="arrow down"></span></button> <button type="button" aria-label="个人分享" class="mobile-dropdown-title"><span class="title">个人分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/index.html" class="nav-link">
  文章
</a></li><li class="dropdown-item"><!----> <a href="/share/opensource.html" class="nav-link">
  开源项目
</a></li><li class="dropdown-item"><!----> <a href="/share/software/" class="nav-link">
  软件推荐
</a></li><li class="dropdown-item"><!----> <a href="/share/website.html" class="nav-link">
  网站推荐
</a></li><li class="dropdown-item"><!----> <a href="/frame/index.html" class="nav-link">
  前端工具框架推荐
</a></li><li class="dropdown-item"><!----> <a href="/share/config/" class="nav-link">
  配置文件
</a></li><li class="dropdown-item"><!----> <a href="/share/notes/" class="nav-link">
  笔记
</a></li></ul></div></div> <a href="https://github.com/LuckRain7" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home/" class="nav-link">
  个人介绍
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/HTML.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/frontend/CSS.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/JavaScript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/TypeScript.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/Vue/Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/React/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/frontend/Webpack/" class="nav-link">
  Webpack
</a></li></ul></div></div><div class="nav-item"><a href="/engineering/engineering/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><span class="title">面试</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试" class="mobile-dropdown-title"><span class="title">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ms/DesignMode.html" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/ms/Algorithm.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/ms/JavaScript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/ms/CSS.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/ms/safe.html" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/ms/Vue.html" class="nav-link">
  Vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端" class="dropdown-title"><span class="title">服务端</span> <span class="arrow down"></span></button> <button type="button" aria-label="服务端" class="mobile-dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/server/Node/" class="nav-link">
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/server/Golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/server/Python/" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="WebGIS" class="dropdown-title"><span class="title">WebGIS</span> <span class="arrow down"></span></button> <button type="button" aria-label="WebGIS" class="mobile-dropdown-title"><span class="title">WebGIS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/WebGIS/index.html" class="nav-link">
  README
</a></li><li class="dropdown-item"><!----> <a href="/WebGIS/Cesium/" class="nav-link">
  Cesium
</a></li><li class="dropdown-item"><!----> <a href="/WebGIS/ArcGIS/" class="nav-link">
  ArcGIS
</a></li><li class="dropdown-item"><!----> <a href="/WebGIS/OpenLayer/" class="nav-link">
  OpenLayer
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="必备工具" class="dropdown-title"><span class="title">必备工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="必备工具" class="mobile-dropdown-title"><span class="title">必备工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/package/" class="nav-link">
  包管理器
</a></li><li class="dropdown-item"><!----> <a href="/tools/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/GitHub/" class="nav-link">
  GitHub
</a></li><li class="dropdown-item"><!----> <a href="/tools/Mac/" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/tools/vscode/" class="nav-link">
  VS Code
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人分享" class="dropdown-title"><span class="title">个人分享</span> <span class="arrow down"></span></button> <button type="button" aria-label="个人分享" class="mobile-dropdown-title"><span class="title">个人分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/article/index.html" class="nav-link">
  文章
</a></li><li class="dropdown-item"><!----> <a href="/share/opensource.html" class="nav-link">
  开源项目
</a></li><li class="dropdown-item"><!----> <a href="/share/software/" class="nav-link">
  软件推荐
</a></li><li class="dropdown-item"><!----> <a href="/share/website.html" class="nav-link">
  网站推荐
</a></li><li class="dropdown-item"><!----> <a href="/frame/index.html" class="nav-link">
  前端工具框架推荐
</a></li><li class="dropdown-item"><!----> <a href="/share/config/" class="nav-link">
  配置文件
</a></li><li class="dropdown-item"><!----> <a href="/share/notes/" class="nav-link">
  笔记
</a></li></ul></div></div> <a href="https://github.com/LuckRain7" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>1. web 缓存</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/engineering/network/cache.html#_1-1-浏览器缓存" class="sidebar-link">1.1. 浏览器缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/engineering/network/cache.html#_1-1-1-强缓存" class="sidebar-link">1.1.1. 强缓存</a></li><li class="sidebar-sub-header"><a href="/engineering/network/cache.html#_1-1-2-协商缓存" class="sidebar-link">1.1.2. 协商缓存</a></li><li class="sidebar-sub-header"><a href="/engineering/network/cache.html#_1-1-3-localstorage-和-sessionstorage" class="sidebar-link">1.1.3. LocalStorage 和 sessionStorage</a></li></ul></li><li><a href="/engineering/network/cache.html#_1-2-数据库缓存" class="sidebar-link">1.2. 数据库缓存</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/engineering/network/cache.html#_1-3-代理服务器缓存" class="sidebar-link">1.3. 代理服务器缓存</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/engineering/network/cache.html#_1-4-cdn-缓存" class="sidebar-link">1.4. CDN 缓存</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-web-缓存"><a href="#_1-web-缓存" class="header-anchor">#</a> 1. web 缓存</h1> <blockquote><p>web 缓存分为很多种，比如<strong>数据库缓存、代理服务器缓存、还有我们熟悉的 CDN 缓存</strong>，以及浏览器缓存。</p> <p>流程：浏览器 -&gt; 代理服务器 -&gt; 资源服务器</p></blockquote> <h2 id="_1-1-浏览器缓存"><a href="#_1-1-浏览器缓存" class="header-anchor">#</a> 1.1. 浏览器缓存</h2> <p><strong>HTTP 缓存又分为强缓存和协商缓存：</strong></p> <ul><li>首先通过 Cache-Control 验证强缓存是否可用，如果强缓存可用，那么直接读取缓存</li> <li>如果不可以，那么进入协商缓存阶段，发起 HTTP 请求，服务器通过请求头中是否带上 If-Modified-Since 和 If-None-Match 这些条件请求字段检查资源是否更新：
<ul><li>若资源更新，那么返回资源和 200 状态码</li> <li>如果资源未更新，那么告诉浏览器直接使用缓存获取资源</li></ul></li></ul> <p><strong>强缓存和协商缓存请求头：</strong></p> <ul><li>强缓存：Expires | Cache-Control
<ul><li>memory cache 内存缓存，一般存放 js，刷新网页</li> <li>disk cache 硬盘缓存，一般存放 css，重新打开网页</li></ul></li> <li>协商缓存：e-tag | Last-modified</li></ul> <p><strong>浏览器加载资源，根据资源的 <code>http</code> <code>header</code> 判断是否命中强缓存；</strong></p> <ul><li>若命中：浏览器直接从自己缓存中读取资源，不会发生 <code>http</code> 请求到服务器；</li> <li>没有命中：浏览器会发送请求到服务器，通过服务器中 <code>http</code> <code>header</code> 验证这个资源是否命中<strong>协商缓存</strong>；
<ul><li>命中：请求返回，但不返回资源，告诉客户端可直接从缓存中加载；</li> <li>没有命中：请求返回，返回资源；</li></ul></li></ul> <p>可以得出：强缓存与协商缓存区别：强缓存不发生请求到服务器，协商缓存会发请求到服务器。</p> <h3 id="_1-1-1-强缓存"><a href="#_1-1-1-强缓存" class="header-anchor">#</a> 1.1.1. 强缓存</h3> <p><strong>页面的缓存状态是由 header 决定的</strong>，header 的参数有四种：</p> <h4 id="_1-1-1-1-cache-control-重要策略"><a href="#_1-1-1-1-cache-control-重要策略" class="header-anchor">#</a> 1.1.1.1. Cache-Control（重要策略）</h4> <ul><li>max-age
<ul><li>（单位为 s）指定设置缓存最大的有效时间，定义的是时间长短</li> <li>max-age=2592000 缓存 30 天，即使服务器上的资源发生了变化，浏览器也不会得到通知。</li> <li>max-age 会覆盖掉 Expires</li></ul></li> <li>s-maxage
<ul><li>（单位为 s）同 max-age，只用于共享缓存（比如 CDN 缓存）。</li> <li>也就是说 max-age 用于普通缓存，而 s-maxage 用于代理缓存。</li> <li>如果存在 s-maxage，则会覆盖掉 max-age 和 Expires header。</li></ul></li> <li>public
<ul><li>指定响应会被缓存，并且在多用户间共享。</li> <li>如果没有指定 public 还是 private，则默认为 public。</li> <li>浏览器 -&gt; 缓存 -&gt; 服务器（先访问缓存，没有在访问服务器）</li></ul></li> <li>private
<ul><li>响应只作为私有的缓存（见下图），不能在用户间共享。</li></ul></li> <li>no-cache
<ul><li>指定不缓存响应，表明资源不进行缓存</li></ul></li> <li>no-store
<ul><li>绝对禁止缓存</li></ul></li> <li>must-revalidate
<ul><li>指定如果页面是过期的，则去服务器进行获取。</li></ul></li></ul> <h4 id="_1-1-1-2-expires"><a href="#_1-1-1-2-expires" class="header-anchor">#</a> 1.1.1.2. Expires</h4> <p>example： <code>Expires: Wed, 01 Mar 2017 11:20:22 GMT</code></p> <p>缓存过期时间，用来指定资源到期的时间，是服务器端的具体的时间点。也就是说，Expires=max-age + 请求时间，需要和 Last-modified 结合使用。但在上面我们提到过，cache-control 的优先级更高。</p> <h3 id="_1-1-2-协商缓存"><a href="#_1-1-2-协商缓存" class="header-anchor">#</a> 1.1.2. 协商缓存</h3> <blockquote><p>协商缓存浏览器响应 Code 是 304</p></blockquote> <h4 id="_1-1-2-1-last-modified"><a href="#_1-1-2-1-last-modified" class="header-anchor">#</a> 1.1.2.1. Last-modified</h4> <ol><li><p>浏览器第一次跟服务器请求一个资源，服务器在返回这个资源的同时，会在 <code>Respone</code> 的 <code>Header</code> 的 <code>Last-Modified</code> 值设置为，该资源最后修改的时间；</p></li> <li><p>第二次请求的时候，在 <code>Request</code> 的 <code>Header</code> 上加上 <code>If-Modified-Since</code>，值为上次请求资源的 <code>Last-Modified</code>；</p></li> <li><p>服务器收到 <code>If-Modified-Since</code> 与服务器文件的 <code>Last-Modified</code> 比对，</p> <ol><li>命中：无变化则返回 <code>304</code> ，不返回资源。浏览器收到 <code>304</code> 使用本地缓存；不更新 <code>Last-Modified</code> ；</li> <li>不命中：有变化返回 <code>200</code> ，重新更新 <code>Last-Modified</code> 、返回 <code>200</code> 、返回资源。</li></ol></li></ol> <p>服务器端文件的最后修改时间，需要和 cache-control 共同使用，是检查服务器端资源是否更新的一种方式。当浏览器再次进行请求时，会向服务器传送 If-Modified-Since 报头，询问 Last-Modified 时间点之后资源是否被修改过。如果没有修改，则返回码为 304，使用缓存；如果修改过，则再次去服务器请求资源，返回码和首次请求相同为 200，资源为服务器最新资源。</p> <h4 id="_1-1-2-2-etag"><a href="#_1-1-2-2-etag" class="header-anchor">#</a> 1.1.2.2. ETag</h4> <blockquote><p>Etag 是服务器响应请求时，返回当前资源文件的一个唯一标识(由服务器生成)。</p></blockquote> <ul><li><p>1、浏览器第一次跟服务器请求一个资源，服务器在返回这个资源的同时，会在 <code>Respone</code> 的 <code>Header</code> 的 <code>ETag</code> 值设置为，该资源当前资源文件的一个唯一标识；</p></li> <li><p>2、第二次请求的时候，在 <code>Request</code> 的 <code>Header</code> 上加上 <code>If-None-Match</code>，值为上次请求资源的 <code>ETag</code>；</p></li> <li><p>3、服务器收到 <code>If-None-Match</code> 与服务器文件的 <code>ETag</code> 比对，</p> <ul><li>命中：一致则返回 <code>304</code>，代表资源无更新，故不返回资源。浏览器将会收到 <code>304</code> 使用本地缓存；更新 <code>ETag</code>；</li> <li>不命中：不一致返回 <code>200</code>，重新更新 <code>ETag</code>、返回 <code>200</code>、返回资源。</li></ul></li></ul> <p>根据实体内容生成一段 hash 字符串，标识资源的状态，由服务端产生。浏览器会将这串字符串传回服务器，验证资源是否已经修改，如果没有修改，过程如下：</p> <ul><li><p>客户端 --&gt;&gt; 请求页面 A --&gt;&gt; 服务器端</p></li> <li><p>客户端 &lt;&lt;-- 页面 A+ETag &lt;&lt;-- 服务器端</p></li> <li><p>客户端 --&gt;&gt; 再次请求页面 A+ETag --&gt;&gt; 服务器端</p></li> <li><p>服务器端 检查 ETag</p></li> <li><p>客户端 &lt;&lt;-- 304+空响应 &lt;&lt;-- 服务器端</p></li></ul> <p>使用 ETag 可以解决 Last-modified 存在的一些问题：</p> <div class="language- extra-class"><pre class="language-text"><code>a、某些服务器不能精确得到资源的最后修改时间，这样就无法通过最后修改时间判断资源是否更新
b、如果资源修改非常频繁，在秒以下的时间内进行修改，而Last-modified只能精确到秒
c、一些资源的最后修改时间改变了，但是内容没改变，使用ETag就认为资源还是没有修改的。
</code></pre></div><h4 id="_1-1-2-3-e-tag-和-last-modified-优先级哪个高"><a href="#_1-1-2-3-e-tag-和-last-modified-优先级哪个高" class="header-anchor">#</a> 1.1.2.3. e-tag 和 Last-Modified 优先级哪个高？**</h4> <p>Last-Modified 与 ETag 是可以一起使用的（见下图），<strong>服务器会优先验证</strong> ETag ，一致的情况下，才会继续比对 Last-Modified，最后才决定是否返回 304 Not Modified。</p> <p>ETag 可以解决 Last-Modified 存在的一些问题，<strong>既生 <code>Last-Modified</code> 何生 <code>ETag</code> ?</strong></p> <ul><li><p>文件内容不更改，但修改时间发生改变，这时候不希望客户端认为这个文件修改了。</p></li> <li><p>某些文件修改非常频繁，比如在秒以下的时间内进行修改，(比方说 <code>1S</code> 内修改了 <code>N</code> 次)，<code>If-Modified-Since</code> 能检查到的粒度是 <code>S</code> 级的，这种修改无法判断；</p></li> <li><p>某些服务器不能精确的得到文件的最后修改时间。</p></li></ul> <h3 id="_1-1-3-localstorage-和-sessionstorage"><a href="#_1-1-3-localstorage-和-sessionstorage" class="header-anchor">#</a> 1.1.3. LocalStorage 和 sessionStorage</h3> <p>除了开头提到的那么多缓存方式以外，还有一种我们都熟悉的缓存方式，<strong>LocalStorage 和 sessionStorage</strong>。</p> <p>LocalStorage 是一种本地存储的公共资源，域名下很多应用共享这份资源会有风险；LocalStorage 是以页面域名划分的，如果有多个等价域名之间的 LocalStorage 不互通，则会造成缓存多份浪费。</p> <p>LocalStorage 在 PC 上的兼容性不太好，而且当网络速度快、协商缓存响应快时使用 localStorage 的速度比不上 304。并且不能缓存 css 文件。而移动端由于网速慢，使用 localStorage 要快于 304。</p> <p>而相对 LocalStorage 来说，SessionStorage 的数据只存储到特定的会话中，不属于持久化的存储，所以关闭浏览器会清除数据。和 localstorage 具有相同的方法。</p> <p>在前端开发中缓存是必不可少的，那么使用怎样的缓存方式更高效、让我们项目的性能更优，还是需要我们仔细斟酌。</p> <h2 id="_1-2-数据库缓存"><a href="#_1-2-数据库缓存" class="header-anchor">#</a> 1.2. 数据库缓存</h2> <h2 id="_1-3-代理服务器缓存"><a href="#_1-3-代理服务器缓存" class="header-anchor">#</a> 1.3. 代理服务器缓存</h2> <h2 id="_1-4-cdn-缓存"><a href="#_1-4-cdn-缓存" class="header-anchor">#</a> 1.4. CDN 缓存</h2> <hr> <p>参考文章:</p> <ul><li><a href="https://juejin.cn/post/6844903546119258125" target="_blank" rel="noopener noreferrer">浏览器缓存<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844904067882287111" target="_blank" rel="noopener noreferrer">浏览器缓存之强缓存与协商缓存<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.935d9423.js" defer></script><script src="/assets/js/2.937ff587.js" defer></script><script src="/assets/js/37.3be73234.js" defer></script>
  </body>
</html>
